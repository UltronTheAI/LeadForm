(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{2158:(e,a,l)=>{Promise.resolve().then(l.bind(l,7438))},4070:e=>{e.exports={modalOverlay:"ViewLeadModal_modalOverlay__ocuWf",modalContent:"ViewLeadModal_modalContent__Kqyar",fadeIn:"ViewLeadModal_fadeIn__1I28M",modalHeader:"ViewLeadModal_modalHeader__cTHQU",modalTitle:"ViewLeadModal_modalTitle__kS8VQ",closeButton:"ViewLeadModal_closeButton__Fkpp5",leadDetails:"ViewLeadModal_leadDetails__sloci",detailRow:"ViewLeadModal_detailRow__YaSY9",detailLabel:"ViewLeadModal_detailLabel__2tc_S",detailValue:"ViewLeadModal_detailValue__aGWaR",messageBox:"ViewLeadModal_messageBox__PeQhD",buttonContainer:"ViewLeadModal_buttonContainer__Vetez",closeModalButton:"ViewLeadModal_closeModalButton___Gkdb"}},4488:e=>{e.exports={modalOverlay:"DeleteConfirmModal_modalOverlay__kOvU2",modalContent:"DeleteConfirmModal_modalContent__3ngMI",fadeIn:"DeleteConfirmModal_fadeIn__EXIbw",modalTitle:"DeleteConfirmModal_modalTitle__eZIwK",modalMessage:"DeleteConfirmModal_modalMessage__sqUeo",errorMessage:"DeleteConfirmModal_errorMessage__r1xfz",buttonContainer:"DeleteConfirmModal_buttonContainer__MH49O",cancelButton:"DeleteConfirmModal_cancelButton__mQKmx",deleteButton:"DeleteConfirmModal_deleteButton__A9L1Z"}},5112:e=>{e.exports={modalOverlay:"TokenModal_modalOverlay__Pzxoi",modalContent:"TokenModal_modalContent__Bb1Xd",fadeIn:"TokenModal_fadeIn__0_gWn",modalTitle:"TokenModal_modalTitle__SsmiF",modalDescription:"TokenModal_modalDescription__hHtOT",modalForm:"TokenModal_modalForm__C53sx",formGroup:"TokenModal_formGroup__upbIZ",formLabel:"TokenModal_formLabel__5UrCw",formInput:"TokenModal_formInput__Nb1On",errorMessage:"TokenModal_errorMessage__HuEU1",submitButton:"TokenModal_submitButton__ytZ23"}},7438:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>N});var s=l(5155),t=l(2115),d=l(8999),n=l(7544),o=l.n(n),i=l(5112),r=l.n(i);let c=e=>{let{onSubmit:a,error:l,setError:d}=e,[n,o]=(0,t.useState)(""),[i,c]=(0,t.useState)(!1),m=async e=>{if(e.preventDefault(),!n.trim())return void d("Please enter a token");c(!0),d(null);try{await a(n)}catch(e){}finally{c(!1)}};return(0,s.jsx)("div",{className:r().modalOverlay,children:(0,s.jsxs)("div",{className:r().modalContent,children:[(0,s.jsx)("h2",{className:r().modalTitle,children:"Admin Authentication"}),(0,s.jsx)("p",{className:r().modalDescription,children:"Please enter your admin token to access the dashboard."}),(0,s.jsxs)("form",{onSubmit:m,className:r().modalForm,children:[(0,s.jsxs)("div",{className:r().formGroup,children:[(0,s.jsx)("label",{htmlFor:"token",className:r().formLabel,children:"Admin Token"}),(0,s.jsx)("input",{type:"password",id:"token",value:n,onChange:e=>o(e.target.value),placeholder:"Enter your admin token",className:r().formInput,disabled:i})]}),l&&(0,s.jsx)("p",{className:r().errorMessage,children:l}),(0,s.jsx)("button",{type:"submit",className:r().submitButton,disabled:i,children:i?"Verifying...":"Login"})]})]})})};var m=l(4488),_=l.n(m);let h=e=>{let{leadName:a,onCancel:l,onConfirm:t,isDeleting:d,error:n}=e;return(0,s.jsx)("div",{className:_().modalOverlay,children:(0,s.jsxs)("div",{className:_().modalContent,children:[(0,s.jsx)("h2",{className:_().modalTitle,children:"Confirm Delete"}),(0,s.jsxs)("p",{className:_().modalMessage,children:["Are you sure you want to delete the lead from ",(0,s.jsx)("strong",{children:a}),"?",(0,s.jsx)("br",{}),"This action cannot be undone."]}),n&&(0,s.jsx)("p",{className:_().errorMessage,children:n}),(0,s.jsxs)("div",{className:_().buttonContainer,children:[(0,s.jsx)("button",{className:_().cancelButton,onClick:l,disabled:d,children:"Cancel"}),(0,s.jsx)("button",{className:_().deleteButton,onClick:t,disabled:d,children:d?"Deleting...":"Delete"})]})]})})};var u=l(4070),x=l.n(u);let j=e=>{let{lead:a,onClose:l}=e;return a?(0,s.jsx)("div",{className:x().modalOverlay,children:(0,s.jsxs)("div",{className:x().modalContent,children:[(0,s.jsxs)("div",{className:x().modalHeader,children:[(0,s.jsx)("h2",{className:x().modalTitle,children:"Lead Details"}),(0,s.jsx)("button",{className:x().closeButton,onClick:l,"aria-label":"Close",children:"\xd7"})]}),(0,s.jsxs)("div",{className:x().leadDetails,children:[(0,s.jsxs)("div",{className:x().detailRow,children:[(0,s.jsx)("div",{className:x().detailLabel,children:"Name:"}),(0,s.jsx)("div",{className:x().detailValue,children:a.name})]}),(0,s.jsxs)("div",{className:x().detailRow,children:[(0,s.jsx)("div",{className:x().detailLabel,children:"Email:"}),(0,s.jsx)("div",{className:x().detailValue,children:a.email})]}),(0,s.jsxs)("div",{className:x().detailRow,children:[(0,s.jsx)("div",{className:x().detailLabel,children:"Phone:"}),(0,s.jsx)("div",{className:x().detailValue,children:a.phone||"Not provided"})]}),(0,s.jsxs)("div",{className:x().detailRow,children:[(0,s.jsx)("div",{className:x().detailLabel,children:"Message:"}),(0,s.jsx)("div",{className:x().detailValue,children:(0,s.jsx)("div",{className:x().messageBox,children:a.message||"Not provided"})})]}),(0,s.jsxs)("div",{className:x().detailRow,children:[(0,s.jsx)("div",{className:x().detailLabel,children:"Created:"}),(0,s.jsx)("div",{className:x().detailValue,children:new Date(a.createdAt).toLocaleString()})]}),a.updatedAt&&a.updatedAt!==a.createdAt&&(0,s.jsxs)("div",{className:x().detailRow,children:[(0,s.jsx)("div",{className:x().detailLabel,children:"Last Updated:"}),(0,s.jsx)("div",{className:x().detailValue,children:new Date(a.updatedAt).toLocaleString()})]})]}),(0,s.jsx)("div",{className:x().buttonContainer,children:(0,s.jsx)("button",{className:x().closeModalButton,onClick:l,children:"Close"})})]})}):null};function N(){let[e,a]=(0,t.useState)(!1),[l,n]=(0,t.useState)(!1),[i,r]=(0,t.useState)([]),[m,_]=(0,t.useState)(!0),[u,x]=(0,t.useState)(null),[N,g]=(0,t.useState)({show:!1,leadId:null,leadName:""}),[v,C]=(0,t.useState)({isDeleting:!1,message:"",isError:!1}),[f,p]=(0,t.useState)(null);(0,d.useRouter)(),(0,t.useEffect)(()=>{let e=localStorage.getItem("adminToken");e?w(e):(n(!0),_(!1))},[]);let b=async e=>{try{await M(e)?(localStorage.setItem("adminToken",e),a(!0),n(!1),w(e)):x("Invalid token. Please check and try again.")}catch(e){console.error("Token validation error:",e),x("An error occurred during validation. Please try again.")}},M=async e=>{try{let a=await fetch("".concat("/api","/verify-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});return(await a.json()).valid}catch(e){return console.error("Error validating token:",e),!1}},w=async e=>{_(!0);try{let l=await fetch("".concat("/api","/leads"),{headers:{Authorization:"Bearer ".concat(e)}});if(!l.ok){if(401===l.status||403===l.status)throw localStorage.removeItem("adminToken"),a(!1),n(!0),Error("Invalid or expired token");throw Error("Failed to fetch leads")}let s=await l.json();r(s),a(!0)}catch(e){console.error("Error fetching leads:",e),x(e.message)}finally{_(!1)}},T=e=>{g({show:!0,leadId:e._id,leadName:e.name})},k=async()=>{let e=localStorage.getItem("adminToken");if(e&&N.leadId){C({isDeleting:!0,message:"",isError:!1});try{let a=await fetch("".concat("/api","/leads/").concat(N.leadId),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to delete lead: ".concat(a.statusText));r(e=>e.filter(e=>e._id!==N.leadId)),C({isDeleting:!1,message:"Lead deleted successfully",isError:!1}),setTimeout(()=>{g({show:!1,leadId:null,leadName:""}),setTimeout(()=>{C({isDeleting:!1,message:"",isError:!1})},3e3)},500)}catch(e){console.error("Error deleting lead:",e),C({isDeleting:!1,message:e.message||"Error deleting lead",isError:!0})}}},y=e=>{p(e)},L=(e,a)=>{if(!e)return"N/A";let l=e.length>a,t=l?"".concat(e.substring(0,a),"..."):e;return l?(0,s.jsx)("span",{className:o().truncatedText,"data-tooltip":e,children:t}):t};return m?(0,s.jsxs)("div",{className:o().loadingContainer,children:[(0,s.jsx)("div",{className:o().spinner}),(0,s.jsx)("p",{children:"Loading..."})]}):(0,s.jsxs)("div",{className:o().adminContainer,children:[l&&(0,s.jsx)(c,{onSubmit:b,error:u,setError:x}),N.show&&(0,s.jsx)(h,{leadName:N.leadName,onCancel:()=>{g({show:!1,leadId:null,leadName:""})},onConfirm:k,isDeleting:v.isDeleting,error:v.isError?v.message:null}),f&&(0,s.jsx)(j,{lead:f,onClose:()=>{p(null)}}),e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:o().adminHeader,children:[(0,s.jsx)("h1",{className:o().adminTitle,children:"Admin Dashboard"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("adminToken"),a(!1),n(!0),r([])},className:o().logoutButton,children:"Logout"})]}),v.message&&!v.isError&&(0,s.jsx)("div",{className:o().successMessage,children:v.message}),(0,s.jsxs)("div",{className:o().leadsContainer,children:[(0,s.jsx)("h2",{className:o().leadsTitle,children:"Leads"}),0===i.length?(0,s.jsx)("p",{className:o().noLeads,children:"No leads found."}):(0,s.jsxs)("table",{className:o().leadsTable,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Name"}),(0,s.jsx)("th",{children:"Email"}),(0,s.jsx)("th",{children:"Phone"}),(0,s.jsx)("th",{children:"Message"}),(0,s.jsx)("th",{children:"Created At"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:i.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:L(e.name,5)}),(0,s.jsx)("td",{children:L(e.email,10)}),(0,s.jsx)("td",{children:L(e.phone,5)}),(0,s.jsx)("td",{className:o().messageCell,children:L(e.message,5)}),(0,s.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsxs)("td",{className:o().actionCell,children:[(0,s.jsx)("button",{className:o().viewButton,onClick:()=>y(e),children:"View"}),(0,s.jsx)("button",{className:o().deleteButton,onClick:()=>T(e),children:"Delete"})]})]},e._id))})]})]})]})]})}},7544:e=>{e.exports={adminContainer:"admin_adminContainer__Eh90a",loadingContainer:"admin_loadingContainer__pFekI",spinner:"admin_spinner__5fXze",spin:"admin_spin__Zlb68",adminHeader:"admin_adminHeader__NWL7e",adminTitle:"admin_adminTitle__6OKzp",logoutButton:"admin_logoutButton__34GO_",leadsContainer:"admin_leadsContainer__VTyO1",leadsTitle:"admin_leadsTitle__rXyOy",noLeads:"admin_noLeads__HrCf1",leadsTable:"admin_leadsTable__hFD6A",messageCell:"admin_messageCell__7sVIL",deleteButton:"admin_deleteButton__CwIux",successMessage:"admin_successMessage__IllSh",fadeInOut:"admin_fadeInOut__rNTqo",actionCell:"admin_actionCell__RfgPj",viewButton:"admin_viewButton__D71rJ",truncatedText:"admin_truncatedText__pXdWo",tooltipFadeIn:"admin_tooltipFadeIn__NSlaE"}}},e=>{var a=a=>e(e.s=a);e.O(0,[175,441,684,358],()=>a(2158)),_N_E=e.O()}]);